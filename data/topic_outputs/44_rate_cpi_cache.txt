for a program is 2% and a data cache miss rate is 4%. If a processor has a CPI of 2 without any memory stalls and the miss penalty is 100 cycles for all misses, determine how much faster a processor would run with a perfect cache that never missed.

---

Assume the frequency of all loads and stores is 36%. Cache Performance Example • Given • I-cache miss rate = 2% • D-cache miss rate = 4% • Base CPI (ideal cache) = 2 • Miss penalty = 100 cycles • Load & stores are 36% of instructions Cache Performance

---

Example • Given • I-cache miss rate = 2% • D-cache miss rate = 4% • Base CPI (ideal cache) = 2 • Miss penalty = 100 cycles • Load & stores are 36% of instructions • Determine miss cycles per instruction • I-cache: 0.02 × 100 = 2 •

---

D-cache: 0.36 × 0.04 × 100 = 1.44 • Memory miss cycles = 2 + 1.44 = 3.44 Cache Performance Example • Given • I-cache miss rate = 2% • D-cache miss rate = 4% • Base CPI (ideal cache) = 2 • Miss penalty = 100 cycles • Load

---

& stores are 36% of instructions • Determine miss cycles per instruction • I-cache: 0.02 × 100 = 2 • D-cache: 0.36 × 0.04 × 100 = 1.44 • Memory miss cycles = 2 + 1.44 = 3.44 • Actual CPI = 2 + 3.44 = 5.44 Cache Performance Example

---

• Given • I-cache miss rate = 2% • D-cache miss rate = 4% • Base CPI (ideal cache) = 2 • Miss penalty = 100 cycles • Load & stores are 36% of instructions • Determine miss cycles per instruction • I-cache: 0.02 × 100 = 2 • D-cache:

---

0.36 × 0.04 × 100 = 1.44 • Memory miss cycles = 2 + 1.44 = 3.44 • Actual CPI = 2 + 3.44 = 5.44 • Ideal CPU is 5.44/2 =2.72 times faster Performance Considerations • What happens if the processor is made faster, but the memory system is

---

not? • The amount of time spent on memory stalls will take up an increasing fraction of the execution time • Amdahl’s law Cache Performance Example Revisit • Suppose we speed up the system by reducing its CPI from 2 to 1 without changing the clock rate. • Actual CPI

---

= 1 + 3.44 = 4.44 • Ideal CPU is 4.44/1 = 4.44 times faster • Amount of time spent on memory stalls increases: • Before: 3.44/5.44 = 63% • Now: 3.44/4.44 = 77% Performance Considerations • Increasing clock rate without changing the memory system also increases the performance lost

---

have a processor with a base CPI of 1.0, assuming all references hit in the primary cache, and a clock rate of 5 GHz. Assume a main memory access time of 100 ns, including all the miss handling. Suppose the miss rate per instruction at the primary cache is 2%.

---

• How much faster will the processor be if we add a secondary cache that has a 5 ns access time for either a hit or a miss and is large enough to reduce the miss rate to main memory to 0.5%? Multilevel Cache Example • Given • CPU base

---

CPI = 1 • CPU clock rate = 5 GHz • Miss rate/instruction = 2% • Main memory access time = 100ns Multilevel Cache Example • Given • CPU base CPI = 1 • CPU clock rate = 5 GHz • Miss rate/instruction = 2% • Main memory access time

---

= 100ns • With just primary cache • Miss penalty = 100ns/0.2ns = 500 cycles • Effective CPI = 1 + 0.02 × 500 = 11 Multilevel Cache Example • Now add L-2 cache • Access time = 5ns • Global miss rate to main memory = 0.5% • Primary

---

miss with L-2 hit • Penalty = 5ns/0.2ns = 25 cycles • Primary miss with L-2 miss • Extra penalty = 500 cycles • CPI = 1 + 0.02 × 25 + 0.005 × 500 =4 • Performance ratio = 11/4 = 2.8 Multilevel Cache Considerations • Primary cache •